<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  Articles by Kevin Chen
 | Solarck</title>

    <meta name="author" content="Kevin Chen"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="https://www.solarck.com/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="https://www.solarck.com/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="https://www.solarck.com/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>
      <link href='https://fonts.googleapis.com/css?family=Expletus+Sans' rel='stylesheet' type='text/css'>


    <link rel="icon" href="https://www.solarck.com/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://www.solarck.com/favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="https://www.solarck.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Solarck - All posts - Atom Feed"/>


  </head>

  <body>

    <div class="container">

      <div class="page-header">
          <a href="https://www.solarck.com" class="avatar-container pull-left">
            <div class="avatar ">
              <div class="side"><img src="https://www.solarck.com/static/avatar.jpg" class="img-responsive"/></div>
            </div>
          </a>
        <h1><a href="https://www.solarck.com">Solarck</a> <small>金融民工与程序猿的结合体</small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://www.solarck.com" title="金融民工与程序猿的结合体">Solarck</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                  <a href="https://www.solarck.com/category/it-bi-ji.html">IT 笔记</a>
                </li>
<li >
                  <a href="https://www.solarck.com/category/itbi-ji.html">IT笔记</a>
                </li>
<li >
                  <a href="https://www.solarck.com/category/jin-rong-bi-ji.html">金融笔记</a>
                </li>
<li >
                  <a href="https://www.solarck.com/pages/aboutme.html">关于我</a>
                </li>
<li >
                  <a href="https://www.solarck.com/pages/resume.html">简历</a>
                </li>

          </ul>


            <form class="navbar-form navbar-right" role="search" action="https://www.solarck.com/search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-12  ">
  <h1>
    <a href="https://www.solarck.com/author/kevin-chen.html" rel="bookmark" title="Permalink to Kevin Chen's articles">Articles by Kevin Chen</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-12 " id="content" role="main">

    <article>
      <header>
        <h2><a href="https://www.solarck.com/tshark-freq-cmd.html" rel="bookmark" title="Permalink to tshark常用命令详解">tshark常用命令详解</a></h2>
      </header>
      <div><h3 id="wiresharkjian jie">Wireshark简介</h3>
<blockquote>
<p>Wireshark&nbsp;是一款免费开源的包分析器。可用于网络排错、网络分析、软件和通讯协议开发以及教学等。tshark是wireshark的cli版本</p>
</blockquote>
<h3 id="an zhuang">安装</h3>
<p>Archlinux</p>
<div class="highlight"><pre><span></span>yaourt -Syu wireshark-cli
</pre></div>
<p>Debian</p>
<div class="highlight"><pre><span></span>apt-get update
apt-get install tshark
</pre></div>
<p>查看权限</p>
<div class="highlight"><pre><span></span>$ getcap /usr/bin/dumpcap
/usr/bin/dumpcap <span class="o">=</span> cap_net_admin,cap_net_raw+eip
</pre></div>
<p>dumpcap的位置也可能在<code>/usr/sbin/dumpcap</code>，如果输出结果不像上面那样，则还需要设置权限</p>
<div class="highlight"><pre><span></span># setcap 'CAP_NET_RAW+eip CAP_NET_ADMIN+eip' /usr/sbin/dumpcap
</pre></div>
<p>把用户添加至wireshark用户组</p>
<div class="highlight"><pre><span></span># gpasswd -a username wireshark
</pre></div>
<p>切换至新用户组</p>
<div class="highlight"><pre><span></span>$ newgrp …</pre></div></div>
      <div><a class="btn btn-primary" href="https://www.solarck.com/tshark-freq-cmd.html"><strong>➟ 查看全文</strong></a></div>
    </article>
    <hr/>
    <article>
      <header>
        <h2><a href="https://www.solarck.com/gift-card-discount-value.html" rel="bookmark" title="Permalink to 充值卡折现价值分析">充值卡折现价值分析</a></h2>
      </header>
      <div><p>前几天，媳妇把收到的一条短信转给我，问我值不值，我的第一反应当然是不值，这种预存方式都是欺负不懂时间价值的人玩的把戏。为了说服她，特地手算折现，但是发现，嗯？好像还是挺值的啊。于是就有了这篇文章，把计算的完整思路和代码贴出来。</p>
<p><img alt="message" src="http://kevinstuchuang.qiniudn.com/blog-pic/gift-card-message.jpg"/></p>
<p><em>注：计算全部使用年华利率按月折现</em></p>
<p>求真正价值的思路很简单，</p>
<blockquote>
<p>真实价值 = 充值卡的标称价值向后折现再折回<span class="math">\(T_0\)</span> - 付出的价格按类似年金的方式收息后把总利息折回<span class="math">\(T_0\)</span>时刻</p>
</blockquote>
<p>代码如下：</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_value</span><span class="p">(</span><span class="n">month_after_use</span><span class="p">,</span> <span class="n">year_yield</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">printlog</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">cash_flow</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="mi">12</span>

    <span class="k">def</span> <span class="nf">discount</span><span class="p">():</span>
        <span class="n">fv</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">cash_flow</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">year_yield</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return …</span></pre></div></div>
      <div><a class="btn btn-primary" href="https://www.solarck.com/gift-card-discount-value.html"><strong>➟ 查看全文</strong></a></div>
    </article>
    <hr/>
    <article>
      <header>
        <h2><a href="https://www.solarck.com/upgrade-lede-to-1806.html" rel="bookmark" title="Permalink to 升级 Openwrt/LEDE 大版本至 18.06">升级 Openwrt/<span class="caps">LEDE</span> 大版本至&nbsp;18.06</a></h2>
      </header>
      <div><h1 id="xia zai sheng ji bao">下载升级包</h1>
<p>首先下载新版文件，点击下方链接中任意一个，进入你的路由器架构，然后搜索路由器型号，如果你已经是 Openwrt/<span class="caps">LEDE</span>&nbsp;系统，可以下载升级包*-squashfs-sysupgrade.bin，如果不是，则要下载完整安装包*-squashfs-factory.img。</p>
<p><a href="https://downloads.openwrt.org/releases/18.06.0/targets/">官方下载</a></p>
<p><a href="https://mirrors.ustc.edu.cn/lede/releases/18.06.0/targets/">中科大</a></p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/lede/releases/18.06.0/targets">清华大学</a></p>
<h1 id="bei fen  &amp; geng xin">备份 <span class="amp">&amp;</span>&nbsp;更新</h1>
<p>下载好文件后，进入路由器 Luci 界面，System &mdash;-&gt; Backup / Flash&nbsp;Firmware</p>
<p><img alt="backup and flash" src="https://ws1.sinaimg.cn/large/65f2a787ly1fxa2pretyzj20qi0jugnh.jpg"/></p>
<p>建议先备份一份配置到本地，备份好后，上传文件，开刷！等待路由器重启后进入后面的步骤。</p>
<h1 id="geng xin yuan">更新源</h1>
<p>关于详细的如何更换源操作，我在<a href="https://www.solarck.com/lede-media-center1.html"><span class="caps">LEDE</span>/OpenWRT 路由器打造家庭媒体影音中心（一）</a>中有写，这里仅给出自定义源文件的内容。</p>
<p><code>vim /etc/opkg/customfeeds.conf</code></p>
<div class="highlight"><pre><span></span><span class="c1">#Tsinghua</span>
<span class="na">src …</span></pre></div></div>
      <div><a class="btn btn-primary" href="https://www.solarck.com/upgrade-lede-to-1806.html"><strong>➟ 查看全文</strong></a></div>
    </article>
    <hr/>
    <article>
      <header>
        <h2><a href="https://www.solarck.com/compile-tensorflow-gpu.html" rel="bookmark" title="Permalink to 编译 Tensorflow 1.10 + CUDA9.2 + MKL">编译 Tensorflow 1.10 + <span class="caps">CUDA9</span>.2 + <span class="caps">MKL</span></a></h2>
      </header>
      <div><p>我的电脑系统是基于 Archlinux 的 Manjaro，软件包更新的比较激进，很早就已经是 <span class="caps">CUDA</span> 9.2 了，而目前 Tensorflow 的官方编译版本对 <span class="caps">CUDA</span> 的支持还只停留在 <span class="caps">CUDA</span> 9.0。由于还不太会用 mxnet 和 pytorch，这时倍加想念 Keras 的简单。最近忙里偷闲研究了一下编译安装&nbsp;Tensorflow，发现还挺简单的，把成功的喜悦分享出来，也供有需要的朋友参考。</p>
<h1 id="cha kan xi tong xin xi">查看系统信息</h1>
<h3 id="cha kan xi tong jia gou he fa xing ban ben">查看系统架构和发行版本</h3>
<p>我用的 Manjaro&nbsp;x86_64</p>
<p><code>uname -m &amp;&amp; cat /etc/*release</code></p>
<div class="highlight"><pre><span></span>x86_64
Manjaro Linux
DISTRIB_ID=ManjaroLinux
DISTRIB_RELEASE=17.1.11
DISTRIB_CODENAME …</pre></div></div>
      <div><a class="btn btn-primary" href="https://www.solarck.com/compile-tensorflow-gpu.html"><strong>➟ 查看全文</strong></a></div>
    </article>
    <hr/>
    <article>
      <header>
        <h2><a href="https://www.solarck.com/systemd-wait-network-online.html" rel="bookmark" title="Permalink to 解决 Haproxy 用 Systemd 启动失败的问题">解决 Haproxy 用 Systemd&nbsp;启动失败的问题</a></h2>
      </header>
      <div><h1 id="wen ti miao shu">问题描述</h1>
<p>配置好 Haproxy 的配置文件，手动可以无错误开启，但是<code>Systemctl enable haproxy.service</code>开机启动每次都报错，系统启动后，手动开启还是没有问题。</p>
<h1 id="fen xi yuan yin">分析原因</h1>
<h3 id="haproxy pei zhi wen ti">haproxy&nbsp;配置问题</h3>
<p><code>/etc/haproxy.cfg</code>是配置文件，因为手动指定配合文件可以启动，而且测试配置文件也没有报错或警报，所以首先排除是配置的问题。</p>
<h3 id="systemd fu wu pei zhi wen ti">systemd&nbsp;服务配置问题</h3>
<p><code>haproxy.service</code>是 systemd 用来启动服务的配置文件，第一眼看配置后，以为是创建 <span class="caps">PID</span> 没有权限，增加<code>User=root</code>字段，但是重启后依然报错。原版配置只有<code>After=network.target</code>，手动添加<code>Wants=network.target</code>重启后，依然报错。</p>
<h3 id="cha kan ri zhi">查看日志 …</h3></div>
      <div><a class="btn btn-primary" href="https://www.solarck.com/systemd-wait-network-online.html"><strong>➟ 查看全文</strong></a></div>
    </article>
    <hr/>

  <nav>
    <ul class="pagination">
        <li class="disabled">
          <a aria-label="Previous" rel="prev">
            <span aria-hidden="true">&larr;</span>
          </a>
        </li>

<li class="active">
            <a href="https://www.solarck.com/author/kevin-chen.html"
              rel="
 first ">
              1
                <span class="sr-only">(current)</span>
            </a>
          </li>
<li class="">
            <a href="https://www.solarck.com/author/kevin-chen2.html"
              rel="
 next ">
              2
            </a>
          </li>
          <li class="disabled"><a>…</a></li>
<li class="">
            <a href="https://www.solarck.com/author/kevin-chen4.html"
              rel="
">
              4
            </a>
          </li>
<li class="">
            <a href="https://www.solarck.com/author/kevin-chen5.html"
              rel="
 last ">
              5
            </a>
          </li>

        <li>
          <a href="https://www.solarck.com/author/kevin-chen2.html"
              aria-label="Next" rel="next">
            <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
    </ul>
  </nav>

        </div>


      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
            </div>
            <div class="col-md-2">
                <h5>链接</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://besticon-demo.herokuapp.com/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>归档</h5>
            <ul class="list-unstyled">
                <li><a href="https://www.solarck.com/categories.html"><i class="fa fa-tags"></i> Categories</a></li>
                <li><a href="https://www.solarck.com/archives.html"><i class="fa fa-calendar"></i> Dates</a></li>
                <li><a href="https://www.solarck.com/tags.html"><i class="fa fa-tag"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright</h5>
            <p>© Copyright 2013-2018 Kevin Chen.</p>
          </div>
        <!--
          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>
        -->
          <div class="col-md-2">
              <h5>Feeds</h5>
              <ul class="list-unstyled">
                  <li><small><a href="https://www.solarck.com/feeds/all.atom.xml"><i class="fa fa-rss"></i> All posts (Atom)</a></small></li>
              </ul>
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1337838-7', 'auto');
    ga('send', 'pageview');
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="https://www.solarck.com/theme/js/jquery.mglass.js"></script>
    <script src="https://www.solarck.com/theme/js/application.js"></script>

  </body>
</html>