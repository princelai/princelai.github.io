<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <title>Solarck</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Solarck  <strong>金融民工与程序猿的结合体</strong></a></h1>
                <nav><ul>
                    <li><a href="/category/itbi-ji.html">IT笔记</a></li>
                    <li><a href="/category/jin-rong-bi-ji.html">金融笔记</a></li>
                </ul></nav>
        </header><!-- /#banner -->

                <section id="content" class="body">
                    <ol id="posts-list" class="hfeed" start="4">
            <li><article class="hentry">
                <header>
                    <h1><a href="/openwrt-samba.html" rel="bookmark"
                           title="Permalink to openwrt开启Samba作为共享中心">openwrt开启Samba作为共享中心</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-01-05T01:29:00+08:00">
                发布时间: 一月 05, 2014
        </abbr>

        <address class="vcard author">
                作者:                         <a class="url fn" href="/author/kevin-chen.html">Kevin Chen</a>
        </address>
<p>分类: <a href="/category/itbi-ji.html">IT笔记</a></p>
<p>标签: <a href="/tag/openwrt.html">openwrt</a> </p>
</footer><!-- /.post-info -->                <p>为Openwrt接入一个大U盘，不用来作共享中心的话实在没什么用处了，这也是为日后脱机BT下载提供一个基础。</p>
<h3>安装</h3>
<div class="highlight"><pre><span></span>opkg update
opkg install samba36-server luci-app-samba
</pre></div>


<!--more-->

<h4>配置文件</h4>
<p>samba的配置文件只有两个，而且默认配置稍作修改就可以使用</p>
<div class="highlight"><pre><span></span>root@openwrt:~# vi /etc/samba/smb.conf.template
<span class="o">[</span>global<span class="o">]</span>
    netbios <span class="nv">name</span> <span class="o">=</span> OpenWrt
    display <span class="nv">charset</span> <span class="o">=</span> UTF-8
    <span class="nv">interfaces</span> <span class="o">=</span> <span class="m">127</span>.0.0.1/8 lo <span class="m">192</span>.168.3.1/24 fd73:3a9a:156::1/60 br-lan <span class="c1">#内网IP</span>
    server <span class="nv">string</span> <span class="o">=</span> OpenWrt …</pre></div>
                <a class="readmore" href="/openwrt-samba.html">查看全文</a>
                <!--<p>There are <a href="/openwrt-samba.html#disqus_thread">comments</a>.</p>-->
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/openwrt-extroot.html" rel="bookmark"
                           title="Permalink to 用extroot为openwrt扩充存储空间">用extroot为openwrt扩充存储空间</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-01-03T01:48:00+08:00">
                发布时间: 一月 03, 2014
        </abbr>

        <address class="vcard author">
                作者:                         <a class="url fn" href="/author/kevin-chen.html">Kevin Chen</a>
        </address>
<p>分类: <a href="/category/itbi-ji.html">IT笔记</a></p>
<p>标签: <a href="/tag/openwrt.html">openwrt</a> </p>
</footer><!-- /.post-info -->                <p>水星这款MW4350r内存为128M，运行很多程序都不在话下。但是却只提供了8M&nbsp;Flash存储空间，而路由器系统还占了1.9M，剩下的5M空间不足以支持安装很多软件，比如我在安装python的时候就报错提示存储空间不足，这确实很郁闷，但幸好Openwrt还提供了extroot方式来扩展存储，来发挥路由器和Openwrt系统的真正实力。</p>
<p><strong>pivot-overlay还是pivot-root？</strong></p>
<blockquote>
<p>我把两种方式都试过，pivot-overlay方式不能够把安装程序的位置移到USB存储装置上，但是pivot-root方式可以，所以我选择了后者。pivot-root方式使/覆盖掉了/overlay成为rootfs，我认为这种方式更接近原生的Linux系统。  <br>
而从官方的文档来看，目前pivot-root已经没有以前的缺点和不足，选择哪个已经是个人需求而不是技术问题了。  <br>
网上大部分文章帖子都是2009-2010年间的，所以大部分可能都是pivot-overlay的。如果对这部分不太理解，请仔细阅读官方Wiki：<a href="http://wiki.openwrt.org/doc/howto/extroot/extroot.theory">ExtRoot: How it works</a>,<a href="http://wiki.openwrt.org/doc/techref/flash.layout">The OpenWrt Flash&nbsp;Layout</a></p>
</blockquote>
<!--more-->

<h3>安装必要的包</h3>
<div class="highlight"><pre><span></span>opkg update
opkg install e2fsprogs kmod-usb-core kmod-usb2 kmod-usb-storage usbutils kmod-fs-ext4 block-mount
</pre></div>


<p>e2fsprogs包提供了mkfs（mkfs.ext3 …</p>
                <a class="readmore" href="/openwrt-extroot.html">查看全文</a>
                <!--<p>There are <a href="/openwrt-extroot.html#disqus_thread">comments</a>.</p>-->
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/install-openwrt-on-mw4530r.html" rel="bookmark"
                           title="Permalink to 水星（Mercury）MW4530r刷Openwrt">水星（Mercury）MW4530r刷Openwrt</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-01-02T01:08:00+08:00">
                发布时间: 一月 02, 2014
        </abbr>

        <address class="vcard author">
                作者:                         <a class="url fn" href="/author/kevin-chen.html">Kevin Chen</a>
        </address>
<p>分类: <a href="/category/itbi-ji.html">IT笔记</a></p>
<p>标签: <a href="/tag/openwrt.html">openwrt</a> </p>
</footer><!-- /.post-info -->                <p>经过两天的不屑折腾，终于为我的Mw4530r安装上了Openwrt。从最后安装成功往回看，其实整个过程非常简单，但是由于是第一次接触，走了不少弯路，本应该一个小时就完成的工作，却整整花了我两天时间。再次发篇文章庆祝下，也给其他朋友一些参考。</p>
<h3>下载文件</h3>
<p>水星这款路由器是ar71xx芯片的，因为较新，所以还没有官方的稳定版。在Openwrt的<a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">snapshots/trunk</a>目录搜索下载我们需要的刷机文件，一般情况一个型号有两个文件，一个名字里带factory，从其他固件系统刷Openwrt下载这个文件；一个名字带sysupgrade，已经是Openwrt系统的用此文件升级。</p>
<h3>刷机</h3>
<p>组装好路由器，接通电源，电脑网卡口连接路由器任意Lan口，打开浏览器访问http://192.168.1.1&nbsp;就可以看见水星的原厂界面。利用原厂固件的升级功能，提交下载好的Openwrt刷机文件即可直接刷机，非常的方便。稍等片刻等待路由器自动重启，此时刷机完成。</p>
<!--more-->

<h3>初始化</h3>
<p>Openwrt的固件是不带UI界面的，在安装用户界面之前，用户需要先进行简单的初始化工作。  <br>&nbsp;使用telnet登陆路由器</p>
<div class="highlight"><pre><span></span>telnet <span class="m">192</span>.168.1.1
</pre></div>


<p>Linux系统自带命令，Windows用户需要在控制面板 …</p>
                <a class="readmore" href="/install-openwrt-on-mw4530r.html">查看全文</a>
                <!--<p>There are <a href="/install-openwrt-on-mw4530r.html#disqus_thread">comments</a>.</p>-->
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/repair-wnr2200.html" rel="bookmark"
                           title="Permalink to 修复变砖的WNR2200">修复变砖的WNR2200</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-12-31T21:51:00+08:00">
                发布时间: 十二月 31, 2013
        </abbr>

        <address class="vcard author">
                作者:                         <a class="url fn" href="/author/kevin-chen.html">Kevin Chen</a>
        </address>
<p>分类: <a href="/category/itbi-ji.html">IT笔记</a></p>
<p>标签: <a href="/tag/lu-you-qi.html">路由器</a> </p>
</footer><!-- /.post-info -->                <p>手中有个NetGear&nbsp;WNR2200路由器，当初买这个就是看重可以刷机,但是买回来才发现只能刷DD-wrt，于是就刷了DD安心的用了半年。  </p>
<p>最近看到Openwrt的trunk目录里有我这款机器的固件了，立刻操刀刷起。不幸的是刷完后telnet不通网关，failsafe模式也无法开启。无奈中发现NetGear官网提供了tftp小工具确实有效，让我变砖的路由器起死回生。</p>
<p>方法也很简单，官方文库里说明的很详细，这里简单记录下要点。  <br>
1.下载工具和路由器官方固件  <br>
2.打开下载好的软件，设置好网关192.168.1.1，加载下载好的固件，密码不用填    <br>&nbsp;3.断开路由器电源10秒左右，之后接通电源，立刻点击软件上的Upgrade，等待修复完成</p>
<!--more-->

<p>修复好后决定这个路由器还是老实的用DD-wrt，抛开扩展性和一些不是特别常用的功能，<span class="caps">DD</span>-wrt确实和所有路由器官方提供的固件一样人性化，当初刷完DD-wrt稳定运行了半年多，无重启、无断流，稳定性不是盖的。不想受Openwrt折磨的人可以在DD-wrt的<a href="ftp://dd-wrt.com/others/eko/BrainSlayer-V24-preSP2">FTP目录</a>里按照日期和型号索引自己的路由器。</p>
<p>当然自己也不会放弃Openwrt，自己又入手了一个水星MW4530r，300元内可刷Openwrt的性价比神器,继续折腾Openwrt去了。</p>
<blockquote>
<p><a href="http://neclub.netgear.cn/Knowledgebase/Document_detail.aspx?Did=934">网件官方文库</a>    <a href="http://www.shadowsoftware.net/shadowgameworld/downloads/tftp2.exe">工具下载地址</a>  <br>
如果地址不可用，可Google&nbsp;tftp2.exe …</p></blockquote>
                <a class="readmore" href="/repair-wnr2200.html">查看全文</a>
                <!--<p>There are <a href="/repair-wnr2200.html#disqus_thread">comments</a>.</p>-->
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
        <a href="/index2.html">&laquo;</a>
    Page 3 / 3
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>链接</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>社交网站</h2>
                        <ul>

                            <li><a href="https://github.com/princelai">Github</a></li>
                            <li><a href="https://plus.google.com/100073068742779779797">G+</a></li>
                            <li><a href="https://twitter.com/princelai">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->
        <!--
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address>

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer>-->
    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1337838-7', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'solarck';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>