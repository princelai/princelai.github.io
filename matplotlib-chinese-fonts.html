<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  matplotlib中文字体配置
 | Solarck</title>

    <meta name="author" content="Kevin Chen"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="https://solarck.com/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="https://solarck.com/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="https://solarck.com/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>
      <link href='https://fonts.googleapis.com/css?family=Expletus+Sans' rel='stylesheet' type='text/css'>


    <link rel="icon" href="https://solarck.com/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://solarck.com/favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="https://solarck.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Solarck - All posts - Atom Feed"/>
      <link href="https://solarck.com/feeds/itbi-ji.atom.xml" type="application/atom+xml" rel="alternate" title="Solarck - Category: IT笔记 - Atom Feed"/>


  </head>

  <body>

    <div class="container">

      <div class="page-header">
          <a href="https://solarck.com" class="avatar-container pull-left">
            <div class="avatar ">
              <div class="side"><img src="static/avatar.jpg" class="img-responsive"/></div>
            </div>
          </a>
        <h1><a href="https://solarck.com">Solarck</a> <small>金融民工与程序猿的结合体</small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://solarck.com" title="金融民工与程序猿的结合体">Solarck</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li  class="active" >
                  <a href="https://solarck.com/category/itbi-ji.html">IT笔记 <span class="sr-only">(current)</span></a>
                </li>
<li >
                  <a href="https://solarck.com/category/jin-rong-bi-ji.html">金融笔记</a>
                </li>
<li >
                  <a href="https://solarck.com/pages/aboutme.html">关于我</a>
                </li>
<li >
                  <a href="https://solarck.com/pages/resume.html">简历</a>
                </li>

          </ul>


            <form class="navbar-form navbar-right" role="search" action="https://solarck.com/search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="https://solarck.com/matplotlib-chinese-fonts.html" rel="bookmark" title="Permalink to matplotlib中文字体配置">matplotlib中文字体配置</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <p>matplotlib是Python的优秀绘图包，但是不论是在Windows还是Linux中默认都是不支持中文的，尤其是在Linux中设置更加复杂一点，设置方法如下：</p>
<p>首先我们需要获取到matplotlib配置文件的文件夹</p>
<div class="highlight"><pre><span></span>python -c <span class="s2">&quot;import matplotlib as mpl;print(mpl.get_configdir())&quot;</span>
/home/kevin/.config/matplotlib
</pre></div>


<!--more-->

<p>然后需要一个默认的matplotlibrc文件用于修改</p>
<div class="highlight"><pre><span></span>python -c <span class="s2">&quot;import matplotlib as mpl;print(mpl.matplotlib_fname())&quot;</span>
/opt/anaconda/lib/python3.6/site-packages/matplotlib/mpl-data/matplotlibrc
</pre></div>


<p>这个位置会根据每个人安装位置不同而改变</p>
<p>然后把默认的rc文件拷贝到用户的配置文件夹</p>
<div class="highlight"><pre><span></span>cp /opt/anaconda/lib/python3.6/site-packages/matplotlib/mpl-data/matplotlibrc ~/.config/matplotlib
</pre></div>


<p>之后的工作都是围绕这个rc文件，一般情况下只需要修改如下两个字段，把注释打开。</p>
<div class="highlight"><pre><span></span>font.sans-serif     : DejaVu Sans, Bitstream Vera Sans, Lucida Grande, Verdana, Geneva
axes.unicode_minus  : False
</pre></div>


<p>第一个字段负责中文字体显示，但是目前还没有，第二个负责正负号的显示。</p>
<p>由于matplotlib不使用系统字体，所以需要找到一个matplotlib支持的字体且已在系统中</p>
<div class="highlight"><pre><span></span>fc-list :lang=zh |grep -i ttf
</pre></div>


<p>在shell中执行这个命令，就能找到几个字体，选择一个填到上面第一行第一个即可，通常建议选择<code>Droid Sans Fallback</code></p>
<p>修改好后重启整个python或ipython之后应该就可以看到中文，不过还是不可以的话可以使用下面方案二查找，这个方法出自<a href="https://segmentfault.com/a/1190000000621721">segmentfault</a>。</p>
<div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontManager</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">fm</span> <span class="o">=</span> <span class="n">FontManager</span><span class="p">()</span>
<span class="n">mat_fonts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fm</span><span class="o">.</span><span class="n">ttflist</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
    <span class="s1">&#39;fc-list :lang=zh -f &quot;%{family}</span><span class="se">\n</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>

<span class="n">zh_fonts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">available</span> <span class="o">=</span> <span class="n">mat_fonts</span> <span class="o">&amp;</span> <span class="n">zh_fonts</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;可用的字体&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>


<p>如果不想使用rc文件来配置，那么可以在每次使用的时候在python中执行以下命令即可。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Droid Sans Fallback&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
</pre></div>
  </div>


    <div class="comments">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'solarck';
        var disqus_identifier = "matplotlib-chinese-fonts.html";
        var disqus_title = "matplotlib中文字体配置";
        var disqus_url = "https://solarck.com/matplotlib-chinese-fonts.html";
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript>
    </div>

        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2017-12-18T16:01:00+08:00"><i class="fa fa-calendar"></i> 十二月 18, 2017</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> 作者:
          <a href="https://solarck.com/author/kevin-chen.html" rel="author">Kevin Chen</a>
      </address></p>

    <hr/>

      <p>
              <a href="https://solarck.com/category/itbi-ji.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="13 articles in this category">IT笔记</a>
            <a href="/tag/python.html" data-toggle="tooltip"
      class="label label-default"
      title="6 articles with this tag">python</a>
            <a href="/tag/matplotlib.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">matplotlib</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
            </div>
            <div class="col-md-2">
                <h5>链接</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://besticon-demo.herokuapp.com/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                  <li>  <a href="http://python.org/">
      <img src="https://besticon-demo.herokuapp.com/icon?url=python.org&size=16" width="16" height="16" class="icon" alt="python.org icon"/>
    Python.org
  </a></li>
                  <li>  <a href="http://jinja.pocoo.org/">
      <img src="https://besticon-demo.herokuapp.com/icon?url=jinja.pocoo.org&size=16" width="16" height="16" class="icon" alt="jinja.pocoo.org icon"/>
    Jinja2
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>归档</h5>
            <ul class="list-unstyled">
                <li><a href="https://solarck.com/categories.html"><i class="fa fa-tags"></i> Categories</a></li>
                <li><a href="https://solarck.com/archives.html"><i class="fa fa-calendar"></i> Dates</a></li>
                <li><a href="https://solarck.com/tags.html"><i class="fa fa-tag"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2013-2018 Kevin Chen.</p>
          </div>
        <!--
          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>
        -->
          <div class="col-md-2">
              <h5>Feeds</h5>
              <ul class="list-unstyled">
                  <li><small><a href="https://solarck.com/feeds/all.atom.xml"><i class="fa fa-rss"></i> All posts (Atom)</a></small></li>
                  <li><small><a href="https://solarck.com/feeds/itbi-ji.atom.xml"><i class="fa fa-rss"></i> Category: IT笔记 (Atom)</a></small></li>
              </ul>
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1337838-7', 'auto');
    ga('send', 'pageview');
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="https://solarck.com/theme/js/jquery.mglass.js"></script>
    <script src="https://solarck.com/theme/js/application.js"></script>

  </body>
</html>